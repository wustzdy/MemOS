import os
import sys
from typing import Optional

src_path = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "..", "src"))
sys.path.insert(0, src_path)

from memos.configs.graph_db import GraphDBConfigFactory
from memos.graph_dbs.factory import GraphStoreFactory


def getNeo4j():
    config = GraphDBConfigFactory(
        backend="neo4j",
        config={
            "uri": os.getenv("NEO4J_URI", "bolt://localhost:7687"),
            "user": os.getenv("NEO4J_USER", "neo4j"),
            "password": os.getenv("NEO4J_PASSWORD", "password"),
            "db_name": os.getenv("NEO4J_DB_NAME", "dbname"),
            "user_name": os.getenv("NEO4J_USER_NAME", "neo4j"),
            "use_multi_db": os.getenv("NEO4J_USE_MULTI_DB", "False").lower() == "true",
            "auto_create": True,
            "embedding_dimension": 1024,
        },
    )
    graph = GraphStoreFactory.from_config(config)
    return graph


def test_search_by_embedding(graph, vector: list[float], user_name: str, filter_example: Optional[dict] = None,knowledgebase_ids: Optional[list[str]] = None):
    """Test search_by_embedding function."""
    # Query search_by_embedding
    nodes = graph.search_by_embedding(
        vector=vector,
        top_k=100,
        user_name=user_name,
        filter=filter_example,
        knowledgebase_ids=knowledgebase_ids,
    )
    print(f"test_search_by_embedding: nodes count: {len(nodes)}")
    print(f"test_search_by_embedding: nodes: {nodes}")
    for node_i in nodes:
        print(f"Search result id: {node_i['id']}, score: {node_i.get('score', 'N/A')}")


def test_get_all_memory_items(graph, scope: str, user_name: str, filter_example: Optional[dict] = None, knowledgebase_ids: Optional[list[str]] = None):
    """Test get_all_memory_items function."""
    memory_items = graph.get_all_memory_items(
        scope=scope, include_embedding=False, user_name=user_name, filter=filter_example, knowledgebase_ids=knowledgebase_ids
    )
    print(f"test_get_all_memory_items: count: {len(memory_items)}")
    print(f"test_get_all_memory_items: {memory_items}")


def test_get_by_metadata(graph, filters: list[dict], user_name: str, filter_example: Optional[dict] = None, knowledgebase_ids: Optional[list[str]] = None):
    """Test get_by_metadata function."""
    ids = graph.get_by_metadata(filters=filters, user_name=user_name, filter=filter_example, knowledgebase_ids=knowledgebase_ids)
    print(f"test_get_by_metadata: count: {len(ids)}")
    print(f"test_get_by_metadata: {ids}")


if __name__ == "__main__":
    vector = [
        0.00036784022813662887,
        0.011101230047643185,
        -0.016430197283625603,
        -0.00498470664024353,
        -0.024183137342333794,
        -0.009238448925316334,
        0.05104490742087364,
        0.01794871687889099,
        -0.003334141569212079,
        -0.010242936201393604,
        -0.0242774561047554,
        0.0008476831135340035,
        -0.02812563069164753,
        -0.020353825762867928,
        0.018505193293094635,
        0.012789522297680378,
        0.031011762097477913,
        -0.01729792356491089,
        -0.0011453743791207671,
        -0.029861081391572952,
        0.019269170239567757,
        0.011469069868326187,
        0.018910761922597885,
        0.0024451944045722485,
        0.043009012937545776,
        0.012204750441014767,
        -0.0681353285908699,
        -0.019052237272262573,
        -0.015911448746919632,
        -0.001834485330618918,
        0.002506501041352749,
        -0.035350389778614044,
        0.020410416647791862,
        -0.002650336129590869,
        -0.024183137342333794,
        -0.02891790121793747,
        -0.020976325497031212,
        -0.00686635123565793,
        -0.01912769302725792,
        0.030351536348462105,
        0.00514976354315877,
        -0.03804788365960121,
        -0.014996564015746117,
        0.03253971412777901,
        -0.028729265555739403,
        -0.05093172565102577,
        -0.04598946124315262,
        0.032992441207170486,
        -0.046744007617235184,
        -0.00742754340171814,
        -0.010205208323895931,
        0.009629868902266026,
        0.03682175278663635,
        0.007243623025715351,
        0.02439063787460327,
        0.029012219980359077,
        -0.03712356835603714,
        0.015345539897680283,
        -0.03208698704838753,
        -0.014034519903361797,
        0.0018887181067839265,
        -0.0008170297369360924,
        0.008946062996983528,
        -0.035803116858005524,
        0.002827182412147522,
        0.08028349280357361,
        0.02163655124604702,
        0.007828394882380962,
        -0.04512173682451248,
        -0.03983992710709572,
        0.014807927422225475,
        0.015402130782604218,
        0.00012828722537960857,
        0.003428459633141756,
        -0.03812333941459656,
        0.026144951581954956,
        0.008196234703063965,
        0.009474243968725204,
        0.013044181279838085,
        0.008837597444653511,
        -0.03440720960497856,
        -0.03550129756331444,
        0.04942263662815094,
        -0.02959699183702469,
        -0.015383267775177956,
        0.018363716080784798,
        0.029200855642557144,
        0.08428257703781128,
        0.014506109990179539,
        -0.057798076421022415,
        -0.06115579977631569,
        0.005494024138897657,
        0.050403546541929245,
        -0.013487475924193859,
        -0.03885902091860771,
        0.002942721825093031,
        -0.06685260683298111,
        0.005281808786094189,
        0.01831655763089657,
        0.040934015065431595,
        -0.00393306091427803,
        0.017458263784646988,
        0.05361035838723183,
        0.022183595225214958,
        -0.013478043489158154,
        -0.021504506468772888,
        -0.01252543181180954,
        0.005324251484125853,
        0.05794898420572281,
        0.015043722465634346,
        0.005116751883178949,
        -0.0031997384503483772,
        0.03099289909005165,
        0.005102604161947966,
        0.014062815345823765,
        -0.015496449545025826,
        -0.019203146919608116,
        -0.0028436880093067884,
        0.0015067302156239748,
        -0.03470902889966965,
        0.02129700593650341,
        0.04349946603178978,
        0.036387886852025986,
        -0.03599175438284874,
        -0.013836451806128025,
        0.041160378605127335,
        -0.027012677863240242,
        -0.006814476102590561,
        0.000047859022743068635,
        -0.015232359059154987,
        0.033426303416490555,
        0.02290041372179985,
        -0.016307583078742027,
        -0.027823813259601593,
        -0.005083740688860416,
        -0.004946979694068432,
        0.014194860123097897,
        0.023824729025363922,
        0.022277913987636566,
        -0.00172130367718637,
        -0.010507026687264442,
        0.05059218034148216,
        -0.004553202074021101,
        -0.034218575805425644,
        0.08337712287902832,
        -0.04444264620542526,
        -0.02505086362361908,
        0.008021746762096882,
        -0.010365549474954605,
        -0.017580877989530563,
        0.01835428550839424,
        -0.006470215506851673,
        0.01901451125741005,
        -0.004937547724694014,
        -0.014072246849536896,
        0.029332900419831276,
        0.012195318937301636,
        -0.004022662993520498,
        -0.0485549122095108,
        -0.012110432609915733,
        0.0014041593531146646,
        -0.026390179991722107,
        -0.05594944208860397,
        0.022975867614150047,
        0.024918818846344948,
        -0.00651737442240119,
        0.03772720322012901,
        0.02803131192922592,
        -0.006569249555468559,
        0.03519948199391365,
        0.001375864027068019,
        -0.017760081216692924,
        -0.01337429415434599,
        -0.0040462426841259,
        -0.002251842524856329,
        0.014194860123097897,
        0.030464718118309975,
        0.03572766110301018,
        0.027993585914373398,
        -0.04746082425117493,
        -0.009356346912682056,
        -0.037161294370889664,
        0.006597544997930527,
        -0.01093145739287138,
        -0.017646899446845055,
        0.006847487762570381,
        0.0024428365286439657,
        -0.050629906356334686,
        0.007861406542360783,
        0.022711776196956635,
        -0.003341215429827571,
        -0.043688103556632996,
        0.012468840926885605,
        -0.013666680082678795,
        0.013421452604234219,
        -0.03829311206936836,
        -0.023598365485668182,
        -0.051535360515117645,
        -0.03391675651073456,
        -0.03335084766149521,
        -0.0006908794166520238,
        -0.009129983372986317,
        -0.003421385772526264,
        -0.012053841724991798,
        -0.0024522682651877403,
        -0.0101957768201828,
        0.03267175704240799,
        0.041386742144823074,
        0.016609402373433113,
        -0.03710470348596573,
        0.020202917978167534,
        0.06296670436859131,
        0.009818504564464092,
        -0.048102185130119324,
        -0.021372461691498756,
        0.00003490871677058749,
        -0.00059774040710181,
        -0.01794871687889099,
        0.047687187790870667,
        -0.03144562616944313,
        0.006507942918688059,
        -0.015354972332715988,
        -0.019769055768847466,
        0.05364808440208435,
        -0.008507484570145607,
        -0.013345998711884022,
        0.014364632777869701,
        0.03142676129937172,
        -0.014590996317565441,
        -0.02948381006717682,
        0.056892622262239456,
        0.029106538742780685,
        0.004211299121379852,
        -0.01548701710999012,
        0.029181992635130882,
        -0.03165312483906746,
        -0.035010844469070435,
        -0.05466672033071518,
        -0.008776291273534298,
        0.01856178417801857,
        0.02857835777103901,
        -0.02665426954627037,
        0.035463571548461914,
        0.014298610389232635,
        -0.018778715282678604,
        -0.004774849396198988,
        -0.001891076099127531,
        0.04700809717178345,
        -0.004692321177572012,
        -0.000635467586107552,
        0.0318794883787632,
        0.0010593091137707233,
        0.0073285093531012535,
        -0.0008246931247413158,
        0.0082528255879879,
        0.020787689834833145,
        0.018910761922597885,
        -0.00995998177677393,
        -0.028899038210511208,
        -0.04051901772618294,
        -0.007021975703537464,
        0.028861310333013535,
        0.016920650377869606,
        0.010799412615597248,
        0.028182221576571465,
        -0.04387673735618591,
        -0.0033435735385864973,
        -0.06055216118693352,
        0.01948610134422779,
        0.006677715107798576,
        0.005597773939371109,
        0.018439171835780144,
        -0.007639758754521608,
        0.0076586222276091576,
        0.023541774600744247,
        -0.01434576977044344,
        -0.050516724586486816,
        -0.050290364772081375,
        0.06504169851541519,
        0.03733106702566147,
        0.03370925784111023,
        0.012091568671166897,
        0.021221552044153214,
        -0.0018580647883936763,
        0.030559035018086433,
        0.04199037700891495,
        0.012968726456165314,
        0.0062014092691242695,
        -0.005140331573784351,
        -0.06805987656116486,
        -0.03419971093535423,
        -0.05179945006966591,
        0.0305024441331625,
        -0.03510516509413719,
        -0.030445853248238564,
        0.02425859309732914,
        0.05602489784359932,
        -0.16056698560714722,
        -0.03459584712982178,
        -0.008323564194142818,
        -0.0008972000796347857,
        -0.00910168793052435,
        0.001984215108677745,
        -0.046404462307691574,
        0.033407438546419144,
        -0.03097403421998024,
        0.009875095449388027,
        -0.01765633188188076,
        -0.0322001688182354,
        0.018420306965708733,
        0.056553080677986145,
        -0.01166713796555996,
        -0.0005620763986371458,
        -0.01611894741654396,
        -0.016034061089158058,
        -0.04044356197118759,
        -0.051988087594509125,
        -0.0052157859317958355,
        -0.0407831072807312,
        0.052780359983444214,
        0.01695837825536728,
        -0.04953581839799881,
        -0.052214451134204865,
        -0.011308729648590088,
        0.01835428550839424,
        0.027050405740737915,
        -0.010242936201393604,
        -0.03714243322610855,
        0.06402306258678436,
        0.0075171454809606075,
        0.020316099748015404,
        0.01684519648551941,
        0.018844738602638245,
        0.04282037541270256,
        -0.028880175203084946,
        -0.03287925943732262,
        0.016307583078742027,
        0.037312205880880356,
        0.04017947241663933,
        -0.012666909024119377,
        0.043424010276794434,
        0.03606720641255379,
        -0.03976447135210037,
        0.02346632070839405,
        0.03442607447504997,
        -0.06394761055707932,
        -0.056100353598594666,
        -0.00024625842343084514,
        -0.045612189918756485,
        -0.0015692159067839384,
        0.07560531795024872,
        -0.0453103706240654,
        -0.044480372220277786,
        -0.019882235676050186,
        0.04508401080965996,
        0.036048345267772675,
        0.015703948214650154,
        -0.02412654645740986,
        -0.047687187790870667,
        -0.009191290475428104,
        -0.021825186908245087,
        -0.049837637692689896,
        0.012883840128779411,
        0.03723675012588501,
        0.01611894741654396,
        0.004284395836293697,
        -0.015902016311883926,
        0.0035958741791546345,
        -0.00954026635736227,
        -0.01058248057961464,
        -0.0029120685067027807,
        0.010997479781508446,
        0.016147242859005928,
        -0.008342428132891655,
        -0.014958836138248444,
        0.04885672777891159,
        -0.11227615922689438,
        0.005621353629976511,
        0.021900642663240433,
        -0.004838514141738415,
        0.01303474884480238,
        -0.004708826541900635,
        -0.017873262986540794,
        -0.017571445554494858,
        0.004824366420507431,
        -0.0008783364901319146,
        0.2655995190143585,
        0.008342428132891655,
        0.008281121030449867,
        0.0010239399271085858,
        -0.008847028948366642,
        -0.009040381759405136,
        -0.04979990795254707,
        0.011478502303361893,
        0.03006858192384243,
        -0.014760768972337246,
        -0.01713758334517479,
        0.03174744173884392,
        -0.009988277219235897,
        0.016430197283625603,
        0.02925744652748108,
        0.03282266855239868,
        0.0027470120694488287,
        0.0009950549574568868,
        0.03040812723338604,
        -0.017147013917565346,
        0.00705970311537385,
        -0.033539485186338425,
        -0.02120268903672695,
        -0.028748130425810814,
        -0.0592317096889019,
        0.027484267950057983,
        -0.010271231643855572,
        -0.02754085883498192,
        -0.0000814229715615511,
        0.06255170702934265,
        -0.018278829753398895,
        0.033426303416490555,
        0.0080924853682518,
        0.03863265737891197,
        -0.031709715723991394,
        -0.033294256776571274,
        0.017505422234535217,
        -0.014704178087413311,
        -0.028163358569145203,
        -0.001375864027068019,
        0.007309645880013704,
        0.01801474019885063,
        0.00019232032354921103,
        0.021108370274305344,
        0.00006134354771347716,
        0.012930999509990215,
        -0.007719929330050945,
        -0.02803131192922592,
        -0.009743050672113895,
        -0.037972431629896164,
        -0.017109287902712822,
        -0.00953083485364914,
        0.018363716080784798,
        0.02574881725013256,
        -0.0048055024817585945,
        -0.00686635123565793,
        -0.0025347964838147163,
        -0.05398762971162796,
        0.02950267307460308,
        0.013100771233439445,
        0.014308041892945766,
        0.036614250391721725,
        -0.05519489943981171,
        -0.004810218699276447,
        0.014374065212905407,
        0.022240186110138893,
        -0.01377042941749096,
        -0.06277807056903839,
        0.06741851568222046,
        -0.012619749642908573,
        -0.04293355718255043,
        0.011714297346770763,
        0.020749961957335472,
        0.0203915536403656,
        0.01919371448457241,
        -0.026710860431194305,
        -0.016996106132864952,
        0.018684398382902145,
        -0.008950779214501381,
        0.027371086180210114,
        -0.01053532212972641,
        0.006248568184673786,
        0.0060882274992764,
        0.060061708092689514,
        0.030577899888157845,
        -0.02618267945945263,
        0.033331986516714096,
        0.0759071335196495,
        0.02733336016535759,
        -0.011629411019384861,
        -0.052553996443748474,
        0.028276540338993073,
        -0.07635986059904099,
        -0.025428134948015213,
        0.009931686334311962,
        -0.0034826926421374083,
        -0.05010172724723816,
        0.003942492883652449,
        -0.05889216437935829,
        0.002205862430855632,
        -0.047989003360271454,
        0.004331554751843214,
        -0.027597449719905853,
        0.03238880634307861,
        0.003793942043557763,
        -0.00626271590590477,
        -0.040254928171634674,
        0.0024074672255665064,
        0.011704864911735058,
        0.02346632070839405,
        0.04259401187300682,
        0.011987819336354733,
        -0.023956773802638054,
        0.023975638672709465,
        -0.04946036636829376,
        0.030804261565208435,
        0.05304444953799248,
        0.01741110533475876,
        0.017826104536652565,
        0.033879030495882034,
        -0.012959294952452183,
        0.0039000497199594975,
        -0.035595618188381195,
        0.01959928311407566,
        0.0057911258190870285,
        -0.03827424719929695,
        -0.025711089372634888,
        0.08216985315084457,
        0.0391608364880085,
        0.017128150910139084,
        -0.03250198811292648,
        -0.022353367879986763,
        -0.017580877989530563,
        0.010837139561772346,
        0.03359607607126236,
        0.006215556990355253,
        0.0016647129086777568,
        -0.013402589596807957,
        0.023070184513926506,
        -0.03040812723338604,
        -0.004553202074021101,
        -0.006522090639919043,
        0.008483905345201492,
        0.011403047479689121,
        0.03682175278663635,
        0.0018486330518499017,
        -0.043801285326480865,
        0.07236077636480331,
        0.015534176491200924,
        0.053233083337545395,
        0.053572628647089005,
        0.040820833295583725,
        0.057118985801935196,
        -0.05515717342495918,
        -0.020240645855665207,
        -0.019637009128928185,
        -0.05749626085162163,
        -0.025880862027406693,
        0.006724874023348093,
        -0.015628494322299957,
        -0.0019005079520866275,
        0.008351859636604786,
        0.04165083169937134,
        0.0872252956032753,
        -0.010176912881433964,
        0.0022082203067839146,
        0.020674508064985275,
        0.05089399963617325,
        -0.01474190503358841,
        -0.013232816942036152,
        -0.028634948655962944,
        -0.03131357952952385,
        -0.03572766110301018,
        0.010167481377720833,
        0.015543607994914055,
        0.01883530616760254,
        0.02493768185377121,
        0.01729792356491089,
        -0.005904307588934898,
        -0.03938720002770424,
        -0.013364861719310284,
        0.03212471306324005,
        0.021957233548164368,
        0.02563563548028469,
        0.013638384640216827,
        0.036953795701265335,
        0.033294256776571274,
        -0.027767222374677658,
        0.06617351621389389,
        -0.007413395680487156,
        -0.03016289882361889,
        0.07337941229343414,
        -0.04089628905057907,
        -0.010337254032492638,
        -0.013072475790977478,
        0.010327822528779507,
        0.05444035679101944,
        -0.017345082014799118,
        0.03401107341051102,
        -0.03086085245013237,
        -0.0598730742931366,
        -0.020768824964761734,
        -0.02095746248960495,
        0.030332671478390694,
        -0.020467007532715797,
        -0.055760808289051056,
        0.018231671303510666,
        0.01833542063832283,
        0.008342428132891655,
        -0.030709944665431976,
        0.011025775223970413,
        -0.020693371072411537,
        0.012478272430598736,
        0.0182882621884346,
        -0.0017295564757660031,
        -0.04500855505466461,
        -0.019637009128928185,
        0.06296670436859131,
        -0.023541774600744247,
        -0.03587857261300087,
        0.012864976190030575,
        -0.010723957791924477,
        -0.004381071776151657,
        -0.015128608793020248,
        0.021674279123544693,
        -0.0026526940055191517,
        0.03087971732020378,
        0.0019146555569022894,
        -0.020448144525289536,
        -0.008620666339993477,
        0.002066743327304721,
        0.012732931412756443,
        -0.0013310628710314631,
        -0.014779631979763508,
        -0.006493795197457075,
        -0.033407438546419144,
        0.020655645057559013,
        0.03563334420323372,
        -0.02188177779316902,
        -0.01657167449593544,
        -0.003961356356739998,
        -0.004010873381048441,
        0.08669711649417877,
        0.062363069504499435,
        0.004758343566209078,
        0.03614266216754913,
        -0.06141988933086395,
        -0.014383496716618538,
        0.07503940910100937,
        0.030351536348462105,
        -0.04055674374103546,
        -0.019231442362070084,
        -0.03133244439959526,
        -0.019844509661197662,
        0.03485993668437004,
        -0.004421156831085682,
        0.022372232750058174,
        -0.01401565596461296,
        0.0038528908044099808,
        -0.06496624648571014,
        0.023994501680135727,
        0.03710470348596573,
        0.02995540015399456,
        0.004449452273547649,
        -0.015722813084721565,
        -0.08292439579963684,
        -0.023485183715820312,
        -0.034803345799446106,
        -0.016552811488509178,
        -0.051988087594509125,
        -0.019108828157186508,
        0.008785722777247429,
        -0.008856461383402348,
        -0.012912135571241379,
        -0.03567107021808624,
        0.021598825231194496,
        -0.043914467096328735,
        0.009445948526263237,
        -0.050064001232385635,
        0.0006496153073385358,
        -0.08903620392084122,
        0.0419149249792099,
        -0.014770200476050377,
        0.01560019887983799,
        -0.017392240464687347,
        -0.006130670662969351,
        -0.006616408471018076,
        -0.006239136215299368,
        -0.01587372086942196,
        -0.046291280537843704,
        0.02446609176695347,
        -0.03587857261300087,
        -0.02105177938938141,
        0.037312205880880356,
        -0.0033718689810484648,
        -0.009342199191451073,
        -0.025088591501116753,
        0.01991996355354786,
        -0.014836222864687443,
        -0.030370399355888367,
        -0.03961356356739998,
        -0.06756941974163055,
        0.01303474884480238,
        -0.006927657872438431,
        0.0307476706802845,
        -0.011289865709841251,
        0.019976554438471794,
        -0.008710267953574657,
        0.0043103331699967384,
        0.014921109192073345,
        -0.04885672777891159,
        -0.028163358569145203,
        0.02310791239142418,
        -0.011214411817491055,
        0.010035436600446701,
        -0.026710860431194305,
        0.06277807056903839,
        -0.0029073527548462152,
        0.004116981290280819,
        0.003440249478444457,
        0.0003112494305241853,
        0.03374698385596275,
        -0.029804490506649017,
        0.037066977471113205,
        0.008498053066432476,
        0.020070873200893402,
        -0.0045249066315591335,
        -0.026390179991722107,
        0.0024334045592695475,
        -0.026012906804680824,
        0.02093859761953354,
        -0.019957691431045532,
        -0.008639529347419739,
        0.009931686334311962,
        0.000795218744315207,
        0.04410310089588165,
        0.02093859761953354,
        0.021259279921650887,
        0.02174973301589489,
        0.03995310887694359,
        0.000977370422333479,
        0.0028484039939939976,
        0.08254712074995041,
        -0.0018450961215421557,
        0.013760997913777828,
        0.02037269063293934,
        -0.06160852313041687,
        -0.003560504876077175,
        -0.0017354513984173536,
        0.018005307763814926,
        -0.015807699412107468,
        -0.008097201585769653,
        -0.04591400921344757,
        0.000021074180040159263,
        0.031936079263687134,
        0.005008286330848932,
        -0.0047795651480555534,
        -0.00887532439082861,
        0.03953811153769493,
        0.030728807672858238,
        -0.031370170414447784,
        0.033520620316267014,
        -0.005494024138897657,
        0.010488162748515606,
        -0.028880175203084946,
        0.043424010276794434,
        0.01686405949294567,
        -0.025899725034832954,
        -0.038783565163612366,
        0.013760997913777828,
        -0.0024027512408792973,
        0.044027648866176605,
        0.03346402943134308,
        -0.01225190982222557,
        -0.04131129011511803,
        0.029766764491796494,
        -0.01613781228661537,
        0.030087444931268692,
        0.014270314946770668,
        0.033652666956186295,
        -0.050969451665878296,
        0.007748224772512913,
        -0.00014037173241376877,
        -0.02550359070301056,
        0.0034709027968347073,
        -0.0016399543965235353,
        0.01741110533475876,
        0.016590537503361702,
        0.007441691122949123,
        0.027993585914373398,
        -0.010648502968251705,
        -0.013874179683625698,
        0.016769742593169212,
        0.03355834633111954,
        -0.12359432131052017,
        0.027257904410362244,
        -0.0051591950468719006,
        0.03472789004445076,
        -0.03953811153769493,
        0.05798671394586563,
        -0.009761913679540157,
        -0.06104261800646782,
        0.0005906665464863181,
        -0.02256086841225624,
        0.0021893568336963654,
        -0.007465270347893238,
        0.03942492976784706,
        -0.010044868104159832,
        -0.032747212797403336,
        -0.00237445579841733,
        -0.03153994306921959,
        0.012157591991126537,
        -0.03599175438284874,
        0.022957004606723785,
        -0.025880862027406693,
        -0.022353367879986763,
        -0.025579044595360756,
        -0.021693142130970955,
        0.0013393157860264182,
        -0.006706010550260544,
        0.0031077784951776266,
        0.01679803803563118,
        0.002025479217991233,
        0.03250198811292648,
        -0.045499008148908615,
        -0.08896074444055557,
        0.006781464908272028,
        0.06583397090435028,
        -0.015656789764761925,
        -0.0027234326116740704,
        0.014411792159080505,
        -0.03257744014263153,
        0.016647128388285637,
        0.044254008680582047,
        0.007276634685695171,
        -0.0014784347731620073,
        -0.0016670707846060395,
        -0.02448495477437973,
        -0.019637009128928185,
        0.05885443836450577,
        0.006451352033764124,
        -0.04432946443557739,
        -0.014732473529875278,
        -0.003961356356739998,
        -0.014647587202489376,
        0.013185657560825348,
        0.0259751807898283,
        0.03176630660891533,
        0.022070415318012238,
        0.01139361597597599,
        -0.018052468076348305,
        0.0021103655453771353,
        -0.03542584553360939,
        0.026031771674752235,
        -0.05455353856086731,
        0.022523140534758568,
        -0.013760997913777828,
        0.03585970774292946,
        -0.033313121646642685,
        0.014496678486466408,
        -0.035803116858005524,
        0.024220865219831467,
        -0.02027837187051773,
        0.001767283771187067,
        -0.031275853514671326,
        -0.0025135749019682407,
        -0.02950267307460308,
        0.015883153304457664,
        -0.0010156871285289526,
        0.05149763450026512,
        0.04040583595633507,
        0.016694288700819016,
        -0.057118985801935196,
        -0.037632886320352554,
        -0.028899038210511208,
        -0.020410416647791862,
        -0.015072017908096313,
        0.022277913987636566,
        -0.03636902570724487,
        -0.008017030544579029,
        -0.0005670870305038989,
        -0.029181992635130882,
        -0.04912082105875015,
        0.036746297031641006,
        -0.03235107660293579,
        -0.02299473062157631,
        -0.018165647983551025,
        -0.03538811579346657,
        -0.03618038818240166,
        0.007507713511586189,
        -0.02450381964445114,
        -0.008743279613554478,
        0.020070873200893402,
        -0.03780265897512436,
        0.024069955572485924,
        -0.029785627499222755,
        0.019137123599648476,
        0.012714067474007607,
        -0.010629639960825443,
        0.021127235144376755,
        0.002258916385471821,
        -0.03574652597308159,
        0.0006171934655867517,
        -0.00552703533321619,
        -0.03163425996899605,
        -0.052780359983444214,
        -0.040254928171634674,
        -0.018816443160176277,
        -0.04523491859436035,
        -0.03584084287285805,
        0.018637238070368767,
        0.010978616774082184,
        -0.03167198970913887,
        0.006795612629503012,
        0.018825875595211983,
        -0.06194806843996048,
        0.05708125978708267,
        -0.043424010276794434,
        0.012685772031545639,
        0.03250198811292648,
        0.007965155877172947,
        0.04266946762800217,
        0.059948526322841644,
        0.0464421883225441,
        0.03442607447504997,
        -0.01613781228661537,
        0.008691404946148396,
        0.015072017908096313,
        0.07107805460691452,
        -0.022372232750058174,
        0.015147472731769085,
        0.010620207525789738,
        0.0021292290184646845,
        -0.02938949130475521,
        -0.012459409423172474,
        -0.03338857740163803,
        -0.020749961957335472,
        -0.051195815205574036,
        0.0009042739402502775,
        0.007304930128157139,
        0.003940134774893522,
        -0.01592087931931019,
        -0.0015857215039432049,
        -0.03276607766747475,
        0.019976554438471794,
        0.000674963288474828,
        -0.028219949454069138,
        0.04006629064679146,
        -0.037519704550504684,
        0.04610264301300049,
        -0.01058248057961464,
        -0.04244310408830643,
        -0.039123110473155975,
        0.030011991038918495,
        -0.006031636614352465,
        0.013949633575975895,
        -0.021561097353696823,
        0.005866580177098513,
        -0.000714458932634443,
        -0.017345082014799118,
        0.0005564762395806611,
        -0.006706010550260544,
        -0.024918818846344948,
        -0.019165419042110443,
        -0.03363380208611488,
        0.055987171828746796,
        -0.014477814547717571,
        -0.009634585119783878,
        0.006993680261075497,
        -0.05523262545466423,
        0.00965344812721014,
        0.012685772031545639,
        0.014251451008021832,
        0.030841989442706108,
        0.004069822374731302,
        -0.0034237438812851906,
        0.03908538445830345,
        0.06794669479131699,
        -0.04614036902785301,
        0.004355133976787329,
        -0.043801285326480865,
        0.01560963038355112,
        0.018571216613054276,
        0.0647398829460144,
        -0.0036265274975448847,
        0.018656102940440178,
        -0.05628898739814758,
        -0.005522319581359625,
        0.025880862027406693,
        0.03817993029952049,
        -0.005295956507325172,
        0.01178031973540783,
        0.005229933653026819,
        0.018590079620480537,
        -0.043801285326480865,
        0.0019794993568211794,
        0.018250534310936928,
        -0.009893959388136864,
        -0.002834256272763014,
        -0.005253513343632221,
        0.014223155565559864,
        -0.01840144395828247,
        -0.004965843167155981,
        -0.03135130554437637,
        -0.028314266353845596,
        -0.03870811313390732,
        -0.014911677688360214,
        0.01629815250635147,
        -0.028785856440663338,
        0.020410416647791862,
        -0.007182316388934851,
        -0.008276405744254589,
        -0.0012449977220967412,
        0.03189834952354431,
        0.03225675970315933,
        0.004541411995887756,
        0.0032091704197227955,
        0.012449976988136768,
        -0.012959294952452183,
        0.02344745770096779,
        -0.0082528255879879,
        -0.002018405357375741,
        0.004890388809144497,
        -0.012242477387189865,
        0.02755972184240818,
        0.028672674670815468,
        0.02093859761953354,
        0.041047196835279465,
        -0.02061791718006134,
        -0.01463815476745367,
        0.002380350837484002,
        -0.0033058463595807552,
        -0.013600656762719154,
        -0.03999083489179611,
        0.049837637692689896,
        -0.0009903390891849995,
        -0.012600886635482311,
        -0.002815392566844821,
    ]
    # Pad vector to 1024 dimensions (fill with zeros for testing)
    vector = vector + [0.0] * (1024 - len(vector))

    # Example filter for testing - common filter used by multiple tests
    filter_example = {
        "and": [
            {"id": "cfe42bd6-ee78-4f6f-b997-8baa0ea957e1"},
            # {"A": "新疆乌鲁木齐市"},
            # {"created_at": {"gt": "2025-09-19"}},
            # {"created_at": {"lt": "2025-11-20"}}
        ]
    }
    knowledgebase_ids = ["adimin1", "adimin2"]

    # Example filters for get_by_metadata
    filters_example = [
        {"field": "status", "op": "=", "value": "activated"},
    ]

    graph = getNeo4j()

    # Or run all tests
    user_name = "memosfeebbc2bd1744d7bb5b5ec57f38e828d"
    scope = "LongTermMemory"
    # test_search_by_embedding(graph, vector, user_name, filter_example,knowledgebase_ids)
    # test_get_all_memory_items(graph, scope, user_name, filter_example, knowledgebase_ids)
    test_get_by_metadata(graph, filters_example, user_name, filter_example, knowledgebase_ids)
